{"ast":null,"code":"function cov_13bfw0kmhb() {\n  var path = \"C:\\\\Users\\\\Me\\\\Documents\\\\Me\\\\fullstack\\\\frontend-v02\\\\src\\\\app\\\\auth\\\\manage-periodic-token-refresh.service.ts\";\n  var hash = \"a440a451b48877fe77b5d1a903061f628bd2e6fe\";\n  var global = new Function(\"return this\")();\n  var gcv = \"__coverage__\";\n  var coverageData = {\n    path: \"C:\\\\Users\\\\Me\\\\Documents\\\\Me\\\\fullstack\\\\frontend-v02\\\\src\\\\app\\\\auth\\\\manage-periodic-token-refresh.service.ts\",\n    statementMap: {\n      \"0\": {\n        start: {\n          line: 7,\n          column: 33\n        },\n        end: {\n          line: 118,\n          column: 1\n        }\n      },\n      \"1\": {\n        start: {\n          line: 9,\n          column: 8\n        },\n        end: {\n          line: 9,\n          column: 39\n        }\n      },\n      \"2\": {\n        start: {\n          line: 10,\n          column: 8\n        },\n        end: {\n          line: 10,\n          column: 35\n        }\n      },\n      \"3\": {\n        start: {\n          line: 11,\n          column: 8\n        },\n        end: {\n          line: 11,\n          column: 23\n        }\n      },\n      \"4\": {\n        start: {\n          line: 12,\n          column: 8\n        },\n        end: {\n          line: 12,\n          column: 43\n        }\n      },\n      \"5\": {\n        start: {\n          line: 15,\n          column: 8\n        },\n        end: {\n          line: 20,\n          column: 11\n        }\n      },\n      \"6\": {\n        start: {\n          line: 17,\n          column: 12\n        },\n        end: {\n          line: 17,\n          column: 54\n        }\n      },\n      \"7\": {\n        start: {\n          line: 19,\n          column: 12\n        },\n        end: {\n          line: 19,\n          column: 42\n        }\n      },\n      \"8\": {\n        start: {\n          line: 21,\n          column: 8\n        },\n        end: {\n          line: 21,\n          column: 38\n        }\n      },\n      \"9\": {\n        start: {\n          line: 24,\n          column: 8\n        },\n        end: {\n          line: 34,\n          column: 11\n        }\n      },\n      \"10\": {\n        start: {\n          line: 26,\n          column: 12\n        },\n        end: {\n          line: 29,\n          column: 42\n        }\n      },\n      \"11\": {\n        start: {\n          line: 30,\n          column: 12\n        },\n        end: {\n          line: 30,\n          column: 43\n        }\n      },\n      \"12\": {\n        start: {\n          line: 31,\n          column: 12\n        },\n        end: {\n          line: 31,\n          column: 55\n        }\n      },\n      \"13\": {\n        start: {\n          line: 33,\n          column: 12\n        },\n        end: {\n          line: 33,\n          column: 42\n        }\n      },\n      \"14\": {\n        start: {\n          line: 37,\n          column: 8\n        },\n        end: {\n          line: 40,\n          column: 58\n        }\n      },\n      \"15\": {\n        start: {\n          line: 38,\n          column: 12\n        },\n        end: {\n          line: 38,\n          column: 88\n        }\n      },\n      \"16\": {\n        start: {\n          line: 39,\n          column: 12\n        },\n        end: {\n          line: 39,\n          column: 29\n        }\n      },\n      \"17\": {\n        start: {\n          line: 43,\n          column: 30\n        },\n        end: {\n          line: 43,\n          column: 88\n        }\n      },\n      \"18\": {\n        start: {\n          line: 44,\n          column: 8\n        },\n        end: {\n          line: 47,\n          column: 38\n        }\n      },\n      \"19\": {\n        start: {\n          line: 48,\n          column: 8\n        },\n        end: {\n          line: 48,\n          column: 37\n        }\n      },\n      \"20\": {\n        start: {\n          line: 49,\n          column: 8\n        },\n        end: {\n          line: 56,\n          column: 9\n        }\n      },\n      \"21\": {\n        start: {\n          line: 53,\n          column: 12\n        },\n        end: {\n          line: 53,\n          column: 32\n        }\n      },\n      \"22\": {\n        start: {\n          line: 54,\n          column: 12\n        },\n        end: {\n          line: 55,\n          column: 56\n        }\n      },\n      \"23\": {\n        start: {\n          line: 57,\n          column: 8\n        },\n        end: {\n          line: 64,\n          column: 28\n        }\n      },\n      \"24\": {\n        start: {\n          line: 61,\n          column: 12\n        },\n        end: {\n          line: 61,\n          column: 57\n        }\n      },\n      \"25\": {\n        start: {\n          line: 62,\n          column: 12\n        },\n        end: {\n          line: 62,\n          column: 29\n        }\n      },\n      \"26\": {\n        start: {\n          line: 63,\n          column: 12\n        },\n        end: {\n          line: 63,\n          column: 77\n        }\n      },\n      \"27\": {\n        start: {\n          line: 67,\n          column: 8\n        },\n        end: {\n          line: 76,\n          column: 11\n        }\n      },\n      \"28\": {\n        start: {\n          line: 70,\n          column: 12\n        },\n        end: {\n          line: 70,\n          column: 44\n        }\n      },\n      \"29\": {\n        start: {\n          line: 71,\n          column: 12\n        },\n        end: {\n          line: 73,\n          column: 13\n        }\n      },\n      \"30\": {\n        start: {\n          line: 72,\n          column: 16\n        },\n        end: {\n          line: 72,\n          column: 46\n        }\n      },\n      \"31\": {\n        start: {\n          line: 75,\n          column: 12\n        },\n        end: {\n          line: 75,\n          column: 42\n        }\n      },\n      \"32\": {\n        start: {\n          line: 83,\n          column: 8\n        },\n        end: {\n          line: 83,\n          column: 34\n        }\n      },\n      \"33\": {\n        start: {\n          line: 84,\n          column: 8\n        },\n        end: {\n          line: 86,\n          column: 9\n        }\n      },\n      \"34\": {\n        start: {\n          line: 85,\n          column: 12\n        },\n        end: {\n          line: 85,\n          column: 56\n        }\n      },\n      \"35\": {\n        start: {\n          line: 89,\n          column: 32\n        },\n        end: {\n          line: 93,\n          column: 9\n        }\n      },\n      \"36\": {\n        start: {\n          line: 94,\n          column: 8\n        },\n        end: {\n          line: 116,\n          column: 12\n        }\n      },\n      \"37\": {\n        start: {\n          line: 97,\n          column: 12\n        },\n        end: {\n          line: 111,\n          column: 13\n        }\n      },\n      \"38\": {\n        start: {\n          line: 98,\n          column: 29\n        },\n        end: {\n          line: 98,\n          column: 59\n        }\n      },\n      \"39\": {\n        start: {\n          line: 99,\n          column: 16\n        },\n        end: {\n          line: 110,\n          column: 17\n        }\n      },\n      \"40\": {\n        start: {\n          line: 100,\n          column: 41\n        },\n        end: {\n          line: 100,\n          column: 75\n        }\n      },\n      \"41\": {\n        start: {\n          line: 101,\n          column: 20\n        },\n        end: {\n          line: 104,\n          column: 50\n        }\n      },\n      \"42\": {\n        start: {\n          line: 105,\n          column: 20\n        },\n        end: {\n          line: 105,\n          column: 46\n        }\n      },\n      \"43\": {\n        start: {\n          line: 106,\n          column: 20\n        },\n        end: {\n          line: 107,\n          column: 58\n        }\n      },\n      \"44\": {\n        start: {\n          line: 108,\n          column: 20\n        },\n        end: {\n          line: 109,\n          column: 41\n        }\n      },\n      \"45\": {\n        start: {\n          line: 112,\n          column: 12\n        },\n        end: {\n          line: 112,\n          column: 37\n        }\n      },\n      \"46\": {\n        start: {\n          line: 114,\n          column: 12\n        },\n        end: {\n          line: 114,\n          column: 61\n        }\n      },\n      \"47\": {\n        start: {\n          line: 115,\n          column: 12\n        },\n        end: {\n          line: 115,\n          column: 41\n        }\n      },\n      \"48\": {\n        start: {\n          line: 119,\n          column: 0\n        },\n        end: {\n          line: 122,\n          column: 2\n        }\n      },\n      \"49\": {\n        start: {\n          line: 119,\n          column: 50\n        },\n        end: {\n          line: 122,\n          column: 1\n        }\n      },\n      \"50\": {\n        start: {\n          line: 123,\n          column: 0\n        },\n        end: {\n          line: 125,\n          column: 31\n        }\n      }\n    },\n    fnMap: {\n      \"0\": {\n        name: \"(anonymous_0)\",\n        decl: {\n          start: {\n            line: 8,\n            column: 4\n          },\n          end: {\n            line: 8,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 8,\n            column: 40\n          },\n          end: {\n            line: 13,\n            column: 5\n          }\n        },\n        line: 8\n      },\n      \"1\": {\n        name: \"(anonymous_1)\",\n        decl: {\n          start: {\n            line: 14,\n            column: 4\n          },\n          end: {\n            line: 14,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 14,\n            column: 26\n          },\n          end: {\n            line: 22,\n            column: 5\n          }\n        },\n        line: 14\n      },\n      \"2\": {\n        name: \"(anonymous_2)\",\n        decl: {\n          start: {\n            line: 16,\n            column: 23\n          },\n          end: {\n            line: 16,\n            column: 24\n          }\n        },\n        loc: {\n          start: {\n            line: 16,\n            column: 44\n          },\n          end: {\n            line: 18,\n            column: 9\n          }\n        },\n        line: 16\n      },\n      \"3\": {\n        name: \"(anonymous_3)\",\n        decl: {\n          start: {\n            line: 18,\n            column: 11\n          },\n          end: {\n            line: 18,\n            column: 12\n          }\n        },\n        loc: {\n          start: {\n            line: 18,\n            column: 20\n          },\n          end: {\n            line: 20,\n            column: 9\n          }\n        },\n        line: 18\n      },\n      \"4\": {\n        name: \"(anonymous_4)\",\n        decl: {\n          start: {\n            line: 23,\n            column: 4\n          },\n          end: {\n            line: 23,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 23,\n            column: 29\n          },\n          end: {\n            line: 35,\n            column: 5\n          }\n        },\n        line: 23\n      },\n      \"5\": {\n        name: \"(anonymous_5)\",\n        decl: {\n          start: {\n            line: 25,\n            column: 23\n          },\n          end: {\n            line: 25,\n            column: 24\n          }\n        },\n        loc: {\n          start: {\n            line: 25,\n            column: 44\n          },\n          end: {\n            line: 32,\n            column: 9\n          }\n        },\n        line: 25\n      },\n      \"6\": {\n        name: \"(anonymous_6)\",\n        decl: {\n          start: {\n            line: 32,\n            column: 11\n          },\n          end: {\n            line: 32,\n            column: 12\n          }\n        },\n        loc: {\n          start: {\n            line: 32,\n            column: 20\n          },\n          end: {\n            line: 34,\n            column: 9\n          }\n        },\n        line: 32\n      },\n      \"7\": {\n        name: \"(anonymous_7)\",\n        decl: {\n          start: {\n            line: 36,\n            column: 4\n          },\n          end: {\n            line: 36,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 36,\n            column: 64\n          },\n          end: {\n            line: 41,\n            column: 5\n          }\n        },\n        line: 36\n      },\n      \"8\": {\n        name: \"(anonymous_8)\",\n        decl: {\n          start: {\n            line: 37,\n            column: 40\n          },\n          end: {\n            line: 37,\n            column: 41\n          }\n        },\n        loc: {\n          start: {\n            line: 37,\n            column: 46\n          },\n          end: {\n            line: 40,\n            column: 9\n          }\n        },\n        line: 37\n      },\n      \"9\": {\n        name: \"(anonymous_9)\",\n        decl: {\n          start: {\n            line: 42,\n            column: 4\n          },\n          end: {\n            line: 42,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 42,\n            column: 43\n          },\n          end: {\n            line: 65,\n            column: 5\n          }\n        },\n        line: 42\n      },\n      \"10\": {\n        name: \"(anonymous_10)\",\n        decl: {\n          start: {\n            line: 57,\n            column: 39\n          },\n          end: {\n            line: 57,\n            column: 40\n          }\n        },\n        loc: {\n          start: {\n            line: 57,\n            column: 45\n          },\n          end: {\n            line: 64,\n            column: 9\n          }\n        },\n        line: 57\n      },\n      \"11\": {\n        name: \"(anonymous_11)\",\n        decl: {\n          start: {\n            line: 66,\n            column: 4\n          },\n          end: {\n            line: 66,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 66,\n            column: 16\n          },\n          end: {\n            line: 77,\n            column: 5\n          }\n        },\n        line: 66\n      },\n      \"12\": {\n        name: \"(anonymous_12)\",\n        decl: {\n          start: {\n            line: 69,\n            column: 23\n          },\n          end: {\n            line: 69,\n            column: 24\n          }\n        },\n        loc: {\n          start: {\n            line: 69,\n            column: 35\n          },\n          end: {\n            line: 74,\n            column: 9\n          }\n        },\n        line: 69\n      },\n      \"13\": {\n        name: \"(anonymous_13)\",\n        decl: {\n          start: {\n            line: 74,\n            column: 11\n          },\n          end: {\n            line: 74,\n            column: 12\n          }\n        },\n        loc: {\n          start: {\n            line: 74,\n            column: 22\n          },\n          end: {\n            line: 76,\n            column: 9\n          }\n        },\n        line: 74\n      },\n      \"14\": {\n        name: \"(anonymous_14)\",\n        decl: {\n          start: {\n            line: 78,\n            column: 4\n          },\n          end: {\n            line: 78,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 78,\n            column: 41\n          },\n          end: {\n            line: 87,\n            column: 5\n          }\n        },\n        line: 78\n      },\n      \"15\": {\n        name: \"(anonymous_15)\",\n        decl: {\n          start: {\n            line: 88,\n            column: 4\n          },\n          end: {\n            line: 88,\n            column: 5\n          }\n        },\n        loc: {\n          start: {\n            line: 88,\n            column: 26\n          },\n          end: {\n            line: 117,\n            column: 5\n          }\n        },\n        line: 88\n      },\n      \"16\": {\n        name: \"(anonymous_16)\",\n        decl: {\n          start: {\n            line: 96,\n            column: 22\n          },\n          end: {\n            line: 96,\n            column: 23\n          }\n        },\n        loc: {\n          start: {\n            line: 96,\n            column: 34\n          },\n          end: {\n            line: 113,\n            column: 9\n          }\n        },\n        line: 96\n      },\n      \"17\": {\n        name: \"(anonymous_17)\",\n        decl: {\n          start: {\n            line: 113,\n            column: 23\n          },\n          end: {\n            line: 113,\n            column: 24\n          }\n        },\n        loc: {\n          start: {\n            line: 113,\n            column: 34\n          },\n          end: {\n            line: 116,\n            column: 9\n          }\n        },\n        line: 113\n      },\n      \"18\": {\n        name: \"(anonymous_18)\",\n        decl: {\n          start: {\n            line: 119,\n            column: 44\n          },\n          end: {\n            line: 119,\n            column: 45\n          }\n        },\n        loc: {\n          start: {\n            line: 119,\n            column: 50\n          },\n          end: {\n            line: 122,\n            column: 1\n          }\n        },\n        line: 119\n      }\n    },\n    branchMap: {\n      \"0\": {\n        loc: {\n          start: {\n            line: 49,\n            column: 8\n          },\n          end: {\n            line: 56,\n            column: 9\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 49,\n            column: 8\n          },\n          end: {\n            line: 56,\n            column: 9\n          }\n        }, {\n          start: {\n            line: undefined,\n            column: undefined\n          },\n          end: {\n            line: undefined,\n            column: undefined\n          }\n        }],\n        line: 49\n      },\n      \"1\": {\n        loc: {\n          start: {\n            line: 71,\n            column: 12\n          },\n          end: {\n            line: 73,\n            column: 13\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 71,\n            column: 12\n          },\n          end: {\n            line: 73,\n            column: 13\n          }\n        }, {\n          start: {\n            line: undefined,\n            column: undefined\n          },\n          end: {\n            line: undefined,\n            column: undefined\n          }\n        }],\n        line: 71\n      },\n      \"2\": {\n        loc: {\n          start: {\n            line: 84,\n            column: 8\n          },\n          end: {\n            line: 86,\n            column: 9\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 84,\n            column: 8\n          },\n          end: {\n            line: 86,\n            column: 9\n          }\n        }, {\n          start: {\n            line: undefined,\n            column: undefined\n          },\n          end: {\n            line: undefined,\n            column: undefined\n          }\n        }],\n        line: 84\n      },\n      \"3\": {\n        loc: {\n          start: {\n            line: 97,\n            column: 12\n          },\n          end: {\n            line: 111,\n            column: 13\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 97,\n            column: 12\n          },\n          end: {\n            line: 111,\n            column: 13\n          }\n        }, {\n          start: {\n            line: undefined,\n            column: undefined\n          },\n          end: {\n            line: undefined,\n            column: undefined\n          }\n        }],\n        line: 97\n      },\n      \"4\": {\n        loc: {\n          start: {\n            line: 99,\n            column: 16\n          },\n          end: {\n            line: 110,\n            column: 17\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 99,\n            column: 16\n          },\n          end: {\n            line: 110,\n            column: 17\n          }\n        }, {\n          start: {\n            line: undefined,\n            column: undefined\n          },\n          end: {\n            line: undefined,\n            column: undefined\n          }\n        }],\n        line: 99\n      }\n    },\n    s: {\n      \"0\": 0,\n      \"1\": 0,\n      \"2\": 0,\n      \"3\": 0,\n      \"4\": 0,\n      \"5\": 0,\n      \"6\": 0,\n      \"7\": 0,\n      \"8\": 0,\n      \"9\": 0,\n      \"10\": 0,\n      \"11\": 0,\n      \"12\": 0,\n      \"13\": 0,\n      \"14\": 0,\n      \"15\": 0,\n      \"16\": 0,\n      \"17\": 0,\n      \"18\": 0,\n      \"19\": 0,\n      \"20\": 0,\n      \"21\": 0,\n      \"22\": 0,\n      \"23\": 0,\n      \"24\": 0,\n      \"25\": 0,\n      \"26\": 0,\n      \"27\": 0,\n      \"28\": 0,\n      \"29\": 0,\n      \"30\": 0,\n      \"31\": 0,\n      \"32\": 0,\n      \"33\": 0,\n      \"34\": 0,\n      \"35\": 0,\n      \"36\": 0,\n      \"37\": 0,\n      \"38\": 0,\n      \"39\": 0,\n      \"40\": 0,\n      \"41\": 0,\n      \"42\": 0,\n      \"43\": 0,\n      \"44\": 0,\n      \"45\": 0,\n      \"46\": 0,\n      \"47\": 0,\n      \"48\": 0,\n      \"49\": 0,\n      \"50\": 0\n    },\n    f: {\n      \"0\": 0,\n      \"1\": 0,\n      \"2\": 0,\n      \"3\": 0,\n      \"4\": 0,\n      \"5\": 0,\n      \"6\": 0,\n      \"7\": 0,\n      \"8\": 0,\n      \"9\": 0,\n      \"10\": 0,\n      \"11\": 0,\n      \"12\": 0,\n      \"13\": 0,\n      \"14\": 0,\n      \"15\": 0,\n      \"16\": 0,\n      \"17\": 0,\n      \"18\": 0\n    },\n    b: {\n      \"0\": [0, 0],\n      \"1\": [0, 0],\n      \"2\": [0, 0],\n      \"3\": [0, 0],\n      \"4\": [0, 0]\n    },\n    inputSourceMap: {\n      version: 3,\n      file: \"manage-periodic-token-refresh.service.js\",\n      sourceRoot: \"\",\n      sources: [\"C:\\\\Users\\\\Me\\\\Documents\\\\Me\\\\fullstack\\\\frontend-v02\\\\src\\\\app\\\\auth\\\\manage-periodic-token-refresh.service.ts\"],\n      names: [],\n      mappings: \"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\",\n      sourcesContent: [\"import {Injectable} from \\\"@angular/core\\\";\\r\\nimport {AuthService} from \\\"./auth.service\\\";\\r\\nimport {of, Subject} from \\\"rxjs\\\";\\r\\nimport {catchError, map} from \\\"rxjs/operators\\\";\\r\\nimport {JwtHelperService} from \\\"@auth0/angular-jwt\\\";\\r\\n\\r\\ninterface ExpirationTimeObj {\\r\\n    default_expired_time: number;\\r\\n    expiration: number;\\r\\n}\\r\\n\\r\\n@Injectable()\\r\\nexport class ManagePeriodicTokenRefresh {\\r\\n    timer: number = 0;\\r\\n    refreshChange: Subject<ExpirationTimeObj> = new Subject<ExpirationTimeObj>();\\r\\n\\r\\n    constructor(\\r\\n        private authService: AuthService,\\r\\n        private jwtHelper: JwtHelperService\\r\\n    ) {\\r\\n    }\\r\\n\\r\\n    public initPeriodicRefresh() {\\r\\n\\r\\n        this.refreshChange\\r\\n            .subscribe(\\r\\n                expirationTimeObj => {\\r\\n                    this.doPeriodicRefresh(expirationTimeObj)\\r\\n                },\\r\\n                error => {\\r\\n                    console.log(\\\"error: \\\", error);\\r\\n                }\\r\\n            )\\r\\n\\r\\n        this.startDoPeriodicRefresh()\\r\\n\\r\\n\\r\\n    }\\r\\n\\r\\n    private startDoPeriodicRefresh() {\\r\\n        this.getTokenExpiredTime()\\r\\n            .subscribe(\\r\\n                expirationTimeObj => {\\r\\n                    console.log(\\r\\n                        '%c expiration: ',\\r\\n                        'background: white; ' +\\r\\n                        'color: red; ' +\\r\\n                        'padding: 10px; ' +\\r\\n                        'border: 1px solid #000'\\r\\n                    );\\r\\n                    console.log(expirationTimeObj)\\r\\n                    this.refreshChange.next(expirationTimeObj);\\r\\n\\r\\n                },\\r\\n                error => {\\r\\n                    console.log(\\\"error: \\\", error);\\r\\n                }\\r\\n            )\\r\\n    }\\r\\n\\r\\n    setIntervalRefreshWithDefaultExpiredTime(expirationTimeObj: ExpirationTimeObj) {\\r\\n        this.timer = window.setInterval(() => {\\r\\n            console.log(\\\"delayed do refresh \\\" + expirationTimeObj.default_expired_time);\\r\\n            this.doRefresh();\\r\\n        }, expirationTimeObj.default_expired_time * 1000);\\r\\n    }\\r\\n\\r\\n    ifRefreshTokenAlive(expirationTimeObj: ExpirationTimeObj) {\\r\\n        let leftExpiredTime = (Number(expirationTimeObj.expiration) * 1000) - Date.now()\\r\\n        console.log(\\r\\n            '%c leftExpiredTime: ',\\r\\n            'background: yellow; ' +\\r\\n            'color: black; ' +\\r\\n            'padding: 10px; ' +\\r\\n            'border: 1px solid #000'\\r\\n        );\\r\\n        console.log(leftExpiredTime)\\r\\n\\r\\n        if (leftExpiredTime < 0) {\\r\\n            /**\\r\\n             * Do refresh now\\r\\n             */\\r\\n\\r\\n            leftExpiredTime = 0;\\r\\n            console.log(\\r\\n                \\\"do refresh now with default expired time \\\" +\\r\\n                expirationTimeObj.default_expired_time\\r\\n            );\\r\\n        }\\r\\n        this.timer = window.setTimeout(() => {\\r\\n            /**\\r\\n             * Program refresh with default time expired\\r\\n             */\\r\\n            console.log(\\\"setTimeout \\\" + leftExpiredTime);\\r\\n            this.doRefresh();\\r\\n            this.setIntervalRefreshWithDefaultExpiredTime(expirationTimeObj)\\r\\n        }, leftExpiredTime);\\r\\n    }\\r\\n\\r\\n    doRefresh() {\\r\\n        this.authService\\r\\n            .refreshTokenOrDie()\\r\\n            .subscribe(\\r\\n                (isAuth) => {\\r\\n                    console.log(\\\"isAuth: \\\", isAuth);\\r\\n                    if (!isAuth) {\\r\\n                        this.startDoPeriodicRefresh()\\r\\n                    }\\r\\n                },\\r\\n                (error) => {\\r\\n                    console.log('error: ', error);\\r\\n                }\\r\\n            )\\r\\n    }\\r\\n\\r\\n    doPeriodicRefresh(expirationTimeObj: ExpirationTimeObj) {\\r\\n        /**\\r\\n         * if expirationTimeObj.expiration equal to -1\\r\\n         * then refresh token is expired\\r\\n         */\\r\\n        clearInterval(this.timer);\\r\\n        if (expirationTimeObj.expiration != -1) {\\r\\n            this.ifRefreshTokenAlive(expirationTimeObj)\\r\\n        }\\r\\n\\r\\n    }\\r\\n\\r\\n    getTokenExpiredTime() {\\r\\n        let expirationTimeObj = {\\r\\n            default_expired_time: 0,\\r\\n            // if refresh token expired\\r\\n            expiration: -1\\r\\n        }\\r\\n        return this.authService\\r\\n            .authState()\\r\\n            .pipe(\\r\\n                map(\\r\\n                    (isAuth) => {\\r\\n\\r\\n                        if (isAuth) {\\r\\n                            let access: string | null = localStorage.getItem('access')\\r\\n                            if (access) {\\r\\n                                const decodedToken = this.jwtHelper.decodeToken(access);\\r\\n                                console.log(\\r\\n                                    '%c decodeToken: ',\\r\\n                                    'background: red; ' +\\r\\n                                    'color: white; ' +\\r\\n                                    'padding: 10px; ' +\\r\\n                                    'border: 1px solid #000'\\r\\n                                );\\r\\n                                console.log(decodedToken)\\r\\n                                expirationTimeObj.default_expired_time =\\r\\n                                    decodedToken.default_expired_time;\\r\\n                                expirationTimeObj.expiration =\\r\\n                                    decodedToken.exp;\\r\\n                            }\\r\\n\\r\\n                        }\\r\\n                        return expirationTimeObj\\r\\n                    }\\r\\n                ),\\r\\n                catchError(\\r\\n                    (error) => {\\r\\n                        console.log('from auth.guard.ts error: ', error);\\r\\n                        return of(expirationTimeObj);\\r\\n                    }\\r\\n                )\\r\\n            )\\r\\n    }\\r\\n\\r\\n}\\r\\n\"]\n    },\n    _coverageSchema: \"1a1c01bbd47fc00a2c39e90264f33305004495a9\",\n    hash: \"a440a451b48877fe77b5d1a903061f628bd2e6fe\"\n  };\n  var coverage = global[gcv] || (global[gcv] = {});\n\n  if (!coverage[path] || coverage[path].hash !== hash) {\n    coverage[path] = coverageData;\n  }\n\n  var actualCoverage = coverage[path];\n  {\n    // @ts-ignore\n    cov_13bfw0kmhb = function () {\n      return actualCoverage;\n    };\n  }\n  return actualCoverage;\n}\n\ncov_13bfw0kmhb();\nimport { __decorate } from \"tslib\";\nimport { Injectable } from \"@angular/core\";\nimport { AuthService } from \"./auth.service\";\nimport { of, Subject } from \"rxjs\";\nimport { catchError, map } from \"rxjs/operators\";\nimport { JwtHelperService } from \"@auth0/angular-jwt\";\ncov_13bfw0kmhb().s[0]++;\nlet ManagePeriodicTokenRefresh = class ManagePeriodicTokenRefresh {\n  constructor(authService, jwtHelper) {\n    cov_13bfw0kmhb().f[0]++;\n    cov_13bfw0kmhb().s[1]++;\n    this.authService = authService;\n    cov_13bfw0kmhb().s[2]++;\n    this.jwtHelper = jwtHelper;\n    cov_13bfw0kmhb().s[3]++;\n    this.timer = 0;\n    cov_13bfw0kmhb().s[4]++;\n    this.refreshChange = new Subject();\n  }\n\n  initPeriodicRefresh() {\n    cov_13bfw0kmhb().f[1]++;\n    cov_13bfw0kmhb().s[5]++;\n    this.refreshChange.subscribe(expirationTimeObj => {\n      cov_13bfw0kmhb().f[2]++;\n      cov_13bfw0kmhb().s[6]++;\n      this.doPeriodicRefresh(expirationTimeObj);\n    }, error => {\n      cov_13bfw0kmhb().f[3]++;\n      cov_13bfw0kmhb().s[7]++;\n      console.log(\"error: \", error);\n    });\n    cov_13bfw0kmhb().s[8]++;\n    this.startDoPeriodicRefresh();\n  }\n\n  startDoPeriodicRefresh() {\n    cov_13bfw0kmhb().f[4]++;\n    cov_13bfw0kmhb().s[9]++;\n    this.getTokenExpiredTime().subscribe(expirationTimeObj => {\n      cov_13bfw0kmhb().f[5]++;\n      cov_13bfw0kmhb().s[10]++;\n      console.log('%c expiration: ', 'background: white; ' + 'color: red; ' + 'padding: 10px; ' + 'border: 1px solid #000');\n      cov_13bfw0kmhb().s[11]++;\n      console.log(expirationTimeObj);\n      cov_13bfw0kmhb().s[12]++;\n      this.refreshChange.next(expirationTimeObj);\n    }, error => {\n      cov_13bfw0kmhb().f[6]++;\n      cov_13bfw0kmhb().s[13]++;\n      console.log(\"error: \", error);\n    });\n  }\n\n  setIntervalRefreshWithDefaultExpiredTime(expirationTimeObj) {\n    cov_13bfw0kmhb().f[7]++;\n    cov_13bfw0kmhb().s[14]++;\n    this.timer = window.setInterval(() => {\n      cov_13bfw0kmhb().f[8]++;\n      cov_13bfw0kmhb().s[15]++;\n      console.log(\"delayed do refresh \" + expirationTimeObj.default_expired_time);\n      cov_13bfw0kmhb().s[16]++;\n      this.doRefresh();\n    }, expirationTimeObj.default_expired_time * 1000);\n  }\n\n  ifRefreshTokenAlive(expirationTimeObj) {\n    cov_13bfw0kmhb().f[9]++;\n    let leftExpiredTime = (cov_13bfw0kmhb().s[17]++, Number(expirationTimeObj.expiration) * 1000 - Date.now());\n    cov_13bfw0kmhb().s[18]++;\n    console.log('%c leftExpiredTime: ', 'background: yellow; ' + 'color: black; ' + 'padding: 10px; ' + 'border: 1px solid #000');\n    cov_13bfw0kmhb().s[19]++;\n    console.log(leftExpiredTime);\n    cov_13bfw0kmhb().s[20]++;\n\n    if (leftExpiredTime < 0) {\n      cov_13bfw0kmhb().b[0][0]++;\n      cov_13bfw0kmhb().s[21]++;\n\n      /**\r\n       * Do refresh now\r\n       */\n      leftExpiredTime = 0;\n      cov_13bfw0kmhb().s[22]++;\n      console.log(\"do refresh now with default expired time \" + expirationTimeObj.default_expired_time);\n    } else {\n      cov_13bfw0kmhb().b[0][1]++;\n    }\n\n    cov_13bfw0kmhb().s[23]++;\n    this.timer = window.setTimeout(() => {\n      cov_13bfw0kmhb().f[10]++;\n      cov_13bfw0kmhb().s[24]++;\n\n      /**\r\n       * Program refresh with default time expired\r\n       */\n      console.log(\"setTimeout \" + leftExpiredTime);\n      cov_13bfw0kmhb().s[25]++;\n      this.doRefresh();\n      cov_13bfw0kmhb().s[26]++;\n      this.setIntervalRefreshWithDefaultExpiredTime(expirationTimeObj);\n    }, leftExpiredTime);\n  }\n\n  doRefresh() {\n    cov_13bfw0kmhb().f[11]++;\n    cov_13bfw0kmhb().s[27]++;\n    this.authService.refreshTokenOrDie().subscribe(isAuth => {\n      cov_13bfw0kmhb().f[12]++;\n      cov_13bfw0kmhb().s[28]++;\n      console.log(\"isAuth: \", isAuth);\n      cov_13bfw0kmhb().s[29]++;\n\n      if (!isAuth) {\n        cov_13bfw0kmhb().b[1][0]++;\n        cov_13bfw0kmhb().s[30]++;\n        this.startDoPeriodicRefresh();\n      } else {\n        cov_13bfw0kmhb().b[1][1]++;\n      }\n    }, error => {\n      cov_13bfw0kmhb().f[13]++;\n      cov_13bfw0kmhb().s[31]++;\n      console.log('error: ', error);\n    });\n  }\n\n  doPeriodicRefresh(expirationTimeObj) {\n    cov_13bfw0kmhb().f[14]++;\n    cov_13bfw0kmhb().s[32]++;\n\n    /**\r\n     * if expirationTimeObj.expiration equal to -1\r\n     * then refresh token is expired\r\n     */\n    clearInterval(this.timer);\n    cov_13bfw0kmhb().s[33]++;\n\n    if (expirationTimeObj.expiration != -1) {\n      cov_13bfw0kmhb().b[2][0]++;\n      cov_13bfw0kmhb().s[34]++;\n      this.ifRefreshTokenAlive(expirationTimeObj);\n    } else {\n      cov_13bfw0kmhb().b[2][1]++;\n    }\n  }\n\n  getTokenExpiredTime() {\n    cov_13bfw0kmhb().f[15]++;\n    let expirationTimeObj = (cov_13bfw0kmhb().s[35]++, {\n      default_expired_time: 0,\n      // if refresh token expired\n      expiration: -1\n    });\n    cov_13bfw0kmhb().s[36]++;\n    return this.authService.authState().pipe(map(isAuth => {\n      cov_13bfw0kmhb().f[16]++;\n      cov_13bfw0kmhb().s[37]++;\n\n      if (isAuth) {\n        cov_13bfw0kmhb().b[3][0]++;\n        let access = (cov_13bfw0kmhb().s[38]++, localStorage.getItem('access'));\n        cov_13bfw0kmhb().s[39]++;\n\n        if (access) {\n          cov_13bfw0kmhb().b[4][0]++;\n          const decodedToken = (cov_13bfw0kmhb().s[40]++, this.jwtHelper.decodeToken(access));\n          cov_13bfw0kmhb().s[41]++;\n          console.log('%c decodeToken: ', 'background: red; ' + 'color: white; ' + 'padding: 10px; ' + 'border: 1px solid #000');\n          cov_13bfw0kmhb().s[42]++;\n          console.log(decodedToken);\n          cov_13bfw0kmhb().s[43]++;\n          expirationTimeObj.default_expired_time = decodedToken.default_expired_time;\n          cov_13bfw0kmhb().s[44]++;\n          expirationTimeObj.expiration = decodedToken.exp;\n        } else {\n          cov_13bfw0kmhb().b[4][1]++;\n        }\n      } else {\n        cov_13bfw0kmhb().b[3][1]++;\n      }\n\n      cov_13bfw0kmhb().s[45]++;\n      return expirationTimeObj;\n    }), catchError(error => {\n      cov_13bfw0kmhb().f[17]++;\n      cov_13bfw0kmhb().s[46]++;\n      console.log('from auth.guard.ts error: ', error);\n      cov_13bfw0kmhb().s[47]++;\n      return of(expirationTimeObj);\n    }));\n  }\n\n};\ncov_13bfw0kmhb().s[48]++;\n\nManagePeriodicTokenRefresh.ctorParameters = () => {\n  cov_13bfw0kmhb().f[18]++;\n  cov_13bfw0kmhb().s[49]++;\n  return [{\n    type: AuthService\n  }, {\n    type: JwtHelperService\n  }];\n};\n\ncov_13bfw0kmhb().s[50]++;\nManagePeriodicTokenRefresh = __decorate([Injectable()], ManagePeriodicTokenRefresh);\nexport { ManagePeriodicTokenRefresh };","map":{"version":3,"sources":["C:/Users/Me/Documents/Me/fullstack/frontend-v02/src/app/auth/manage-periodic-token-refresh.service.ts"],"names":["__decorate","Injectable","AuthService","of","Subject","catchError","map","JwtHelperService","ManagePeriodicTokenRefresh","constructor","authService","jwtHelper","timer","refreshChange","initPeriodicRefresh","subscribe","expirationTimeObj","doPeriodicRefresh","error","console","log","startDoPeriodicRefresh","getTokenExpiredTime","next","setIntervalRefreshWithDefaultExpiredTime","window","setInterval","default_expired_time","doRefresh","ifRefreshTokenAlive","leftExpiredTime","Number","expiration","Date","now","setTimeout","refreshTokenOrDie","isAuth","clearInterval","authState","pipe","access","localStorage","getItem","decodedToken","decodeToken","exp","ctorParameters","type"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Injectable } from \"@angular/core\";\r\nimport { AuthService } from \"./auth.service\";\r\nimport { of, Subject } from \"rxjs\";\r\nimport { catchError, map } from \"rxjs/operators\";\r\nimport { JwtHelperService } from \"@auth0/angular-jwt\";\r\nlet ManagePeriodicTokenRefresh = class ManagePeriodicTokenRefresh {\r\n    constructor(authService, jwtHelper) {\r\n        this.authService = authService;\r\n        this.jwtHelper = jwtHelper;\r\n        this.timer = 0;\r\n        this.refreshChange = new Subject();\r\n    }\r\n    initPeriodicRefresh() {\r\n        this.refreshChange\r\n            .subscribe(expirationTimeObj => {\r\n            this.doPeriodicRefresh(expirationTimeObj);\r\n        }, error => {\r\n            console.log(\"error: \", error);\r\n        });\r\n        this.startDoPeriodicRefresh();\r\n    }\r\n    startDoPeriodicRefresh() {\r\n        this.getTokenExpiredTime()\r\n            .subscribe(expirationTimeObj => {\r\n            console.log('%c expiration: ', 'background: white; ' +\r\n                'color: red; ' +\r\n                'padding: 10px; ' +\r\n                'border: 1px solid #000');\r\n            console.log(expirationTimeObj);\r\n            this.refreshChange.next(expirationTimeObj);\r\n        }, error => {\r\n            console.log(\"error: \", error);\r\n        });\r\n    }\r\n    setIntervalRefreshWithDefaultExpiredTime(expirationTimeObj) {\r\n        this.timer = window.setInterval(() => {\r\n            console.log(\"delayed do refresh \" + expirationTimeObj.default_expired_time);\r\n            this.doRefresh();\r\n        }, expirationTimeObj.default_expired_time * 1000);\r\n    }\r\n    ifRefreshTokenAlive(expirationTimeObj) {\r\n        let leftExpiredTime = (Number(expirationTimeObj.expiration) * 1000) - Date.now();\r\n        console.log('%c leftExpiredTime: ', 'background: yellow; ' +\r\n            'color: black; ' +\r\n            'padding: 10px; ' +\r\n            'border: 1px solid #000');\r\n        console.log(leftExpiredTime);\r\n        if (leftExpiredTime < 0) {\r\n            /**\r\n             * Do refresh now\r\n             */\r\n            leftExpiredTime = 0;\r\n            console.log(\"do refresh now with default expired time \" +\r\n                expirationTimeObj.default_expired_time);\r\n        }\r\n        this.timer = window.setTimeout(() => {\r\n            /**\r\n             * Program refresh with default time expired\r\n             */\r\n            console.log(\"setTimeout \" + leftExpiredTime);\r\n            this.doRefresh();\r\n            this.setIntervalRefreshWithDefaultExpiredTime(expirationTimeObj);\r\n        }, leftExpiredTime);\r\n    }\r\n    doRefresh() {\r\n        this.authService\r\n            .refreshTokenOrDie()\r\n            .subscribe((isAuth) => {\r\n            console.log(\"isAuth: \", isAuth);\r\n            if (!isAuth) {\r\n                this.startDoPeriodicRefresh();\r\n            }\r\n        }, (error) => {\r\n            console.log('error: ', error);\r\n        });\r\n    }\r\n    doPeriodicRefresh(expirationTimeObj) {\r\n        /**\r\n         * if expirationTimeObj.expiration equal to -1\r\n         * then refresh token is expired\r\n         */\r\n        clearInterval(this.timer);\r\n        if (expirationTimeObj.expiration != -1) {\r\n            this.ifRefreshTokenAlive(expirationTimeObj);\r\n        }\r\n    }\r\n    getTokenExpiredTime() {\r\n        let expirationTimeObj = {\r\n            default_expired_time: 0,\r\n            // if refresh token expired\r\n            expiration: -1\r\n        };\r\n        return this.authService\r\n            .authState()\r\n            .pipe(map((isAuth) => {\r\n            if (isAuth) {\r\n                let access = localStorage.getItem('access');\r\n                if (access) {\r\n                    const decodedToken = this.jwtHelper.decodeToken(access);\r\n                    console.log('%c decodeToken: ', 'background: red; ' +\r\n                        'color: white; ' +\r\n                        'padding: 10px; ' +\r\n                        'border: 1px solid #000');\r\n                    console.log(decodedToken);\r\n                    expirationTimeObj.default_expired_time =\r\n                        decodedToken.default_expired_time;\r\n                    expirationTimeObj.expiration =\r\n                        decodedToken.exp;\r\n                }\r\n            }\r\n            return expirationTimeObj;\r\n        }), catchError((error) => {\r\n            console.log('from auth.guard.ts error: ', error);\r\n            return of(expirationTimeObj);\r\n        }));\r\n    }\r\n};\r\nManagePeriodicTokenRefresh.ctorParameters = () => [\r\n    { type: AuthService },\r\n    { type: JwtHelperService }\r\n];\r\nManagePeriodicTokenRefresh = __decorate([\r\n    Injectable()\r\n], ManagePeriodicTokenRefresh);\r\nexport { ManagePeriodicTokenRefresh };\r\n"]},"metadata":{},"sourceType":"module"}